\pgfplotstablecreatecol[create col/assign/.code={%
  \getthisrow{Etot}\entryval%
  %\ifnum\pgfplotstablerow>0
  \pgfmathsetmacro{\entryval}{min(\entryval,\pgfmathaccuma)}%
  %\fi
  \edef\pgfmathaccuma{\entryval}
  \pgfkeyslet{/pgfplots/table/create col/next content}\entryval
}
]{Emin}\ScanButane %
\pgfplotstablecreatecol[create col/assign/.code={%
  \getthisrow{Etot}\entryval%
  \getthisrow{Emin}\refval%
  %\ifnum\pgfplotstablerow>0
  \pgfmathsetmacro{\entryval}{\entryval - \refval}%
  \pgfmathsetmacro{\entryval}{\AUtoKJM * \entryval}%
  %\fi
  \edef\pgfmathaccuma{\entryval}
  \pgfkeyslet{/pgfplots/table/create col/next content}\entryval
}
]{Erel}\ScanButane %
\pgfplotstablesave[columns={Tau,Etot,Erel}]{\ScanButane}{Results/ScanButane.save.dat}

\pgfplotstablecreatecol[%
create col/assign/.code={%
  \getthisrow{Etot}\entry%
  %\ifnum\pgfplotstablerow>0
  \pgfmathsetmacro{\entry}{min(\entry,\pgfmathaccuma)}%
  %\fi
  \edef\pgfmathaccuma{\entry}
  \pgfkeyslet{/pgfplots/table/create col/next content}\entry
}]{Emin}\ScanMeOEt %
\pgfplotstablecreatecol[%
create col/assign/.code={%
  \getthisrow{Etot}\entryval%
  \getthisrow{Emin}\refval%
  %\ifnum\pgfplotstablerow>0
  \pgfmathsetmacro{\entryval}{\entryval - \refval}%
  \pgfmathsetmacro{\entryval}{\AUtoKJM * \entryval}%
  %\fi
  \edef\pgfmathaccuma{\entryval}
  \pgfkeyslet{/pgfplots/table/create col/next content}\entryval
}
]{Erel}\ScanMeOEt %
\pgfplotstablesave[columns={Tau,Etot,Erel}]{\ScanMeOEt}{Results/ScanMeOEt.save.dat}

\pgfplotstablecreatecol[create col/assign/.code={%
  \getthisrow{Etot}\entry %
  %\ifnum\pgfplotstablerow>0
  \pgfmathsetmacro{\entry}{min(\entry,\pgfmathaccuma)}%
  %\fi
  \edef\pgfmathaccuma{\entry}
  \pgfkeyslet{/pgfplots/table/create col/next content}\entry
}]{Emin}\ScanMeSEt %
\pgfplotstablecreatecol[create col/assign/.code={ %
  \getthisrow{Etot}\entryval %
  \getthisrow{Emin}\refval %
  %\ifnum\pgfplotstablerow>0
  \pgfmathsetmacro{\entryval}{\entryval - \refval}%
  \pgfmathsetmacro{\entryval}{\AUtoKJM * \entryval}%
  %\fi
  \edef\pgfmathaccuma{\entryval}
  \pgfkeyslet{/pgfplots/table/create col/next content}\entryval
} %
]{Erel}\ScanMeSEt %
\pgfplotstablesave[columns={Tau,Etot,Erel}]{\ScanMeSEt}{Results/ScanMeSEt.save.dat}

\pgfplotstablecreatecol[create col/assign/.code={%
  \getthisrow{Etot}\entry%
  %\ifnum\pgfplotstablerow>0
  \pgfmathsetmacro{\entry}{min(\entry,\pgfmathaccuma)}%
  %\fi
  \edef\pgfmathaccuma{\entry}
  \pgfkeyslet{/pgfplots/table/create col/next content}\entry
} %
]{Emin}\ScanMeCOEt %
\pgfplotstablecreatecol[create col/assign/.code={%
  \getthisrow{Etot}\entryval%
  \getthisrow{Emin}\refval%
  %\ifnum\pgfplotstablerow>0
  \pgfmathsetmacro{\entryval}{\entryval - \refval}%
  \pgfmathsetmacro{\entryval}{\AUtoKJM * \entryval}%
  %\fi
  \edef\pgfmathaccuma{\entryval}
  \pgfkeyslet{/pgfplots/table/create col/next content}\entryval
} %
]{Erel}\ScanMeCOEt %
\pgfplotstablesave[columns={Tau,Etot,Erel}]{\ScanMeCOEt}{Results/ScanMeCOEt.save.dat}

\begin{figure}
  \caption{Потенциалы внутреннего вращения молекул \cmpd{Butane}--\cmpd{Butanone}\label{fig:Internal:Rotation:Butanes}}
  \centerfloat{
    \begin{tikzpicture}
      \begin{axis} [%
        %title={\chemfig{H_3C-[:+30]\circ-[:-30]\circ-[:+30]CH_3}},
        %legend pos=outer north east,
        legend style={draw=none},
        xlabel={\chemfig{[,0.875]H_3C-[:+30]\circ-[:-30]\circ-[:+30]CH_3} / $\tau$,~\textdegree},
        xmin=-180, xmax=180,
        xtick={-180,-120,...,180},
        ylabel={$\Delta\Func{E}$,~\si{\kilo\joule\per\mole}},
        ymin=-1, ymax=32]
        \addplot [black,thick,smooth,domain=-180:180] table [x=Tau,y=Erel] 
        {Results/ScanButane.save.dat};\addlegendentry{\chemfig{[,0.675]-[:+30]-[:-30]-[:+30]}~\cmpd{Butane}}
        \addplot [red,thick,smooth,domain=-180:180] table [x=Tau,y=Erel]
        {Results/ScanMeOEt.save.dat};\addlegendentry{\chemfig{[,0.675]-[:+30]-[:-30]O-[:+30]}~\cmpd{MeOEt}}
        \addplot [brown,thick,smooth,domain=-180:180] table [x=Tau,y=Erel] 
        {Results/ScanMeSEt.save.dat};\addlegendentry{\chemfig{[,0.675]-[:+30]-[:-30]S-[:+30]}~\cmpd{MeSEt}}
        \addplot [green,thick,smooth,domain=-180:180] table [x=Tau,y=Erel] 
        {Results/ScanMeCOEt.save.dat}; \addlegendentry{\chemfig{[,0.675]-[:+30]-[:-30]C(=[:-90]O)-[:+30]}~\cmpd{Butanone}}
      \end{axis}
    \end{tikzpicture}
  }
\end{figure}

